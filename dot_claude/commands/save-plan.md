# save-plan

## 概要
以下について調査・分析を行い、実装計画を作成してSCRATCH_PAD.mdファイルに保存してください。web検索も実施して最新の情報を元に作成してください。

## トピック
```
$ARGUMENT
```


## 動作内容
1. 指定されたトピックを解析
2. 関連する調査を実施：
   - 現在のコードベースの分析（該当する場合）
   - 関連ドキュメントや既存の解決方法をweb検索
   - ベストプラクティスの検討
   - 実装に必要な技術スタックの確認
   - **技術仕様の最新情報取得**: 利用する技術（フレームワーク、ライブラリなど）については、context7 MCPサーバーから最新の仕様・ドキュメントを取得
3. 調査結果に基づいて実装計画を作成
   - **実装タスクの場合**: TDD（テスト駆動開発）アプローチでタスクリストを作成
4. SCRATCH_PAD.mdファイルに計画を保存：
   - 新規作成または既存ファイルへの追加
   - タイムスタンプ付きセクションとして保存

## 保存形式
計画は以下の形式で保存されます：

```markdown
## [日時] - [計画タイトル]
作成日時: YYYY-MM-DD HH:MM:SS
トピック: [ARGUMENTで指定された内容]

### 調査結果
[実施した調査の概要と発見事項]

### 現状分析
[現在のコードベースや環境の分析結果]

### 実装計画
[詳細な実装計画と推奨アプローチ]

### タスクリスト
- [ ] タスク1（優先度: 高）
- [ ] タスク2（優先度: 中）
- [ ] タスク3（優先度: 低）

**実装タスクの場合のTDDアプローチ**:
1. 失敗するテストを書く (Red)
2. テストを通すための最小限のコードを書く (Green)
3. コードをリファクタリングする (Refactor)

### 技術的考慮事項
[実装時の注意点、依存関係、リスクなど]

### 参考
検索したwebサイトなどのリファレンス

---
```

## 実装詳細
このコマンドを実行すると、以下の処理を行います：

1. **トピック解析**
   - ARGUMENTの内容を分析
   - 調査範囲と計画の方向性を決定

2. **調査フェーズ**
   - 複数のClaude Codeタスクエージェントを並列起動して効率的な調査を実施
     - コードベースの関連部分を検索・分析（タスク1）
     - 必要な技術やライブラリの調査（タスク2）
     - context7 MCPサーバーを使用した最新技術仕様の取得（タスク3）
     - ベストプラクティスの確認とweb検索（タスク4）
   - 各タスクの結果を統合して包括的な調査レポートを作成
   - **調査レビューフェーズ**: 別タスクエージェントで調査レポートをレビューし、修正・補完が必要な部分を特定

3. **計画作成**
   - 調査結果を基に実装計画を立案
   - タスクの優先順位付けと工数見積もり
   - 実装タスクの場合はTDDアプローチでタスクリストを作成
   - 技術的な考慮事項の整理

4. **保存処理**
   - SCRATCH_PAD.mdファイルの確認・作成
   - タイムスタンプ付きセクションとして追加
   - 既存の計画との重複を避けるため、新規セクションとして保存

5. **通知**
   - 計画作成・保存完了時にterminal-notifierで通知


## 注意事項
- SCRATCH_PAD.mdは各ワーキングディレクトリごとに作成されます
- 大規模な調査が必要な場合は、段階的に実行することを推奨

## 重要な実装時の注意事項
**タスクリスト実行時の必須確認事項**:
- タスクリストを実行する際は、**一気に全て実装せず**、必ずユーザーに確認を取りながら段階的に進める
- 特にTDDアプローチでは以下を厳守：
  - **テスト作成フェーズ**と**実装フェーズ**を同時に実行しない
  - 各フェーズ（Red → Green → Refactor）ごとにユーザーの承認を得る
  - テストが失敗することを確認してから次の実装フェーズに進む
- 大きなタスクは小さな単位に分割し、各段階でユーザーの意見を求める
- 予期しない問題や設計変更が必要な場合は、必ず実装前にユーザーに相談する
