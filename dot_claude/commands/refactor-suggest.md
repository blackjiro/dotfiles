---
description: コードベースを分析してリファクタリング案をGitHub Issueとして提案する
allowed-tools: ["Bash", "Read", "Write"]
---

# リファクタリング提案ワークフロー

## あなたの役割

シニアソフトウェアエンジニアとして、このコードベースを分析し、具体的で実行可能なリファクタリング案を提案してください。

## ステップ1: 既存Issueの確認

まず、既に提案済みのリファクタリングを確認してください：

```bash
gh issue list --label "refactor" --state all --json title,body,number --limit 100
```

上記の結果をメモし、**重複する提案は絶対に行わない**でください。

## ステップ2: コードベース分析

以下の観点でコードを分析してください：

### 優先度: 高

- **重複コード**: 同じまたは類似のロジックが複数箇所に存在
- **長すぎる関数/クラス**: 単一責任の原則に違反
- **循環的複雑度が高い**: ネストが深い、条件分岐が多い
- **マジックナンバー/ハードコード**: 定数化されていない値

### 優先度: 中

- **命名の改善**: 意図が不明確な変数名・関数名
- **エラーハンドリング**: 不十分な例外処理
- **型安全性**: any型の多用、型定義の欠如

### 優先度: 低

- **パフォーマンス**: N+1クエリ、不要な再計算
- **設計パターン**: より適切なパターンへの移行
- **依存関係**: 密結合の解消

## ステップ3: 提案の作成

各リファクタリング案について、以下の形式でIssueを作成してください：

### Issueタイトル

`[Refactor] <簡潔で具体的な説明>`

### Issue本文テンプレート

```markdown
## 概要

[何をリファクタリングするか1-2文で]

## 現状の問題

- [具体的な問題点]
- [該当ファイル: `path/to/file.ts` L10-50]

## 提案する改善

[具体的な改善内容]

## 期待される効果

- [ ] 可読性向上
- [ ] 保守性向上
- [ ] パフォーマンス改善
- [ ] テスト容易性向上

## 実装の複雑さ

- [ ] 小 (1-2時間)
- [ ] 中 (半日-1日)
- [ ] 大 (1日以上)

## 影響範囲

[変更が影響を与えるモジュール・機能]
```

## ステップ4: GitHub Issueの作成

```bash
gh issue create \
  --title "[Refactor] <タイトル>" \
  --body "<本文>" \
  --label "refactor"
```

## 制約事項

- 1回の実行で提案するのは **最大3件** まで
- 既存のIssue（open/closed両方）と重複する提案は **スキップ**
- 実際のコード変更は行わない（提案のみ）
- 各提案は具体的なファイル・行番号を含めること

## 追加オプション: $ARGUMENTS

引数が指定された場合、その領域に焦点を当てて分析：

- `$ARGUMENTS` が空: 全体を分析
- `$ARGUMENTS` が指定: 指定されたディレクトリ/ファイルを重点的に分析
