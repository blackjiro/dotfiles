---
allowed-tools: Read, Write, Edit, Glob, LS
description: "設計書を基にタスクを分解し、並列実行可能なタスクをフェーズごとにグループ化して提示するコマンド。優先度を設定し、効率的な作業計画を支援します。"
---

# タスク分割

設計書を基にタスクを分解します: $ARGUMENTS

## 実行手順

### 1. 設計書の読み込み

対象となる設計書を特定します：

- **引数指定あり**: $ARGUMENTSで指定されたファイル名を使用
- **引数指定なし**: `docs/design/`ディレクトリから最新のファイルを自動選択

設計書から以下の情報を抽出します：

- 実装範囲
- 技術要素
- モジュール構成
- 機能要件

### 2. タスクの洗い出し（TDD方式）

設計書の内容に基づいて、TDD（テスト駆動開発）の流れでタスクを洗い出します：

- **テストファースト**: 各機能に対して、まずテストを書くタスクを定義
- **最小実装**: テストを通すための最小限の実装タスク
- **リファクタリング**: コード品質向上のためのリファクタリングタスク
- **設定タスク**: 環境構築、設定ファイルの作成
- **ドキュメント更新**: README、API仕様書、使用方法などのドキュメント更新

### 3. 依存関係の分析

各タスクの依存関係を分析し、以下を特定します：

- **前提条件**: 他のタスクの完了が必要なもの
- **独立タスク**: 他のタスクに依存せず、即座に開始可能なもの
- **後続タスク**: 他のタスクの完了後に実行可能なもの

### 4. フェーズ分けとグループ化（TDDサイクル）

設計書の実装スコープに基づいて、依存関係を考慮しながら適切なフェーズに分けます。フェーズ数は実装内容により柔軟に調整します。

### 5. タスクリストの生成

実装は開始せずに、`docs/tasks/`ディレクトリに以下の形式でタスクリストを生成します：

```markdown
# [プロジェクト名] タスクリスト

## 概要

- 対象設計書: [設計書ファイル名]

## Phase 1: [機能グループ名]（並列実行可能）

### [機能名A]

- [ ] [タスク1]
- [ ] [タスク2]
- [ ] [タスク3]

### [機能名B]

- [ ] [タスク1]
- [ ] [タスク2]

## Phase 2: [依存機能グループ名]（Phase 1の一部完了後）

### [機能名C]

- [ ] [タスク1]
  - 前提: [依存するタスク]
- [ ] [タスク2]
  - 前提: [依存するタスク]

### [機能名D]

- [ ] [タスク1]
- [ ] [タスク2]

[以降、必要なフェーズ数だけ続く]

## 作業の進め方

### TDDサイクルの実践

- **Red**: まず失敗するテストを書く
- **Green**: テストを通すための最小限のコードを書く
- **Refactor**: テストが通った状態でコードを改善する

### 並列作業の推奨

- 各フェーズ内の独立したタスクは並列で実行可能です
- 機能ごとに異なるメンバーが担当可能です
- 依存関係がない限り、各機能のTDDサイクルは独立して進められます

### 注意事項

- テストを書く前に実装コードを書かないこと
- Greenフェーズでは最小限の実装に留めること
- リファクタリングはテストが全て通ってから行うこと
- 前提条件が明記されているタスクは、該当タスクの完了を待つ必要があります

### フェーズ完了時の確認事項

- 各フェーズの完了時には必ず以下を確認すること：
  - 型チェックが通ること（例: `npm run typecheck`, `tsc --noEmit`）
  - リンターが通ること（例: `npm run lint`, `eslint .`）
  - すべてのテストが通ること（例: `npm test`）
- エラーがある場合は次のフェーズに進まず、修正してから進むこと
```

## 使用例

```
/tasks                                    # 最新の設計書を使用
/tasks 001_user_management_design.md     # 特定の設計書を指定
/tasks ECサイト決済機能設計               # プロジェクト名で指定
```

## 注意事項

- タスクリストは`docs/tasks/`ディレクトリに、`[連番]_[プロジェクト名]_tasks.md`の形式で保存されます
- チェックボックス形式で出力されるため、進捗管理に活用できます
- 実際の作業中に依存関係の見直しが必要になった場合は、適宜更新してください
- 既存のタスクリストがある場合は、上書きするか確認します

