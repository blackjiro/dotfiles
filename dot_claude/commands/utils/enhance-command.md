---
allowed-tools: Read(*), Write(*), Edit(*), MultiEdit(*), Glob(*), Grep(*), LS(*), Task(*), TodoWrite(*), TodoRead(*)
description: "既存のClaude Codeカスタムコマンドを分析・強化し、プロンプトとワークフローを最適化する高度なメタコマンド"
---

# Enhance Custom Command

既存のClaude Codeカスタムコマンドを分析・強化し、より効果的なコマンドに進化させます: $ARGUMENTS

## Phase 1: コマンド分析

### 1.1 対象コマンドの特定
- ARGUMENTSからコマンド名やパスを抽出
- 指定がない場合は対話的に選択を促す
- コマンドファイルの読み込みと構造解析

### 1.2 現状分析
- **メタデータ評価**
  - allowed-toolsの妥当性チェック
  - descriptionの明確性評価
  - 不足している権限の特定

- **構造分析**
  - セクション構成の評価
  - ワークフローの論理性チェック
  - エラーハンドリングの充実度

- **プロンプト品質評価**
  - 明確性と具体性のスコアリング
  - 冗長性や曖昧性の検出
  - コンテキスト活用度の評価

## Phase 2: 最適化戦略

### 2.1 プロンプトエンジニアリング
```markdown
## 最適化技法
1. **Chain-of-Thought強化**
   - 段階的思考プロセスの明示化
   - 論理的な流れの最適化

2. **Few-Shot Examples追加**
   - 具体的な使用例の充実
   - エッジケースの例示

3. **制約と期待値の明確化**
   - 成功基準の定量化
   - 失敗条件の明示

4. **コンテキスト最適化**
   - 必要最小限のコンテキスト読み込み
   - 動的コンテキスト参照の活用
```

### 2.2 ワークフロー改善
- **並列処理の活用**
  - 独立したタスクの並列実行
  - リソース効率の最大化

- **条件分岐の最適化**
  - 早期リターンパターンの適用
  - エラーハンドリングの前置

- **ツール使用の効率化**
  - 最適なツール選択
  - バッチ処理の活用

## Phase 3: 強化実装

### 3.1 改善提案の生成
```markdown
# 改善提案レポート

## 1. 即時改善項目
- [ ] [具体的な改善内容]
- [ ] [期待される効果]

## 2. 構造的改善
- [ ] セクション再構成案
- [ ] ワークフロー最適化案

## 3. 高度な機能追加
- [ ] 動的パラメータ処理
- [ ] インテリジェントエラーリカバリー
- [ ] 学習型最適化機能
```

### 3.2 強化版コマンドの生成
- 元のコマンドをバックアップ
- 最適化された新バージョンを作成
- A/Bテスト可能な構成

## Phase 4: 品質保証

### 4.1 検証項目
- **機能性テスト**
  - 全ワークフローパスの動作確認
  - エッジケースの処理確認

- **パフォーマンス評価**
  - 実行時間の測定
  - リソース使用量の最適化

- **ユーザビリティ評価**
  - 使いやすさの向上度
  - ドキュメントの充実度

### 4.2 メトリクス収集
```yaml
performance_metrics:
  - execution_time: before vs after
  - token_usage: optimization_rate
  - error_rate: reduction_percentage
  - user_satisfaction: feedback_score
```

## Phase 5: 継続的改善

### 5.1 フィードバックループ
- 使用パターンの分析
- エラーログの収集
- 改善提案の自動生成

### 5.2 バージョン管理
- 変更履歴の記録
- ロールバック機能
- A/Bテスト結果の蓄積

## 高度な最適化技法

### パターン認識による自動改善
```markdown
## 認識パターン
1. **冗長性パターン**
   - 重複する処理の統合
   - 共通処理の抽出

2. **非効率パターン**
   - 逐次処理の並列化候補
   - 不要なコンテキスト読み込み

3. **エラー頻発パターン**
   - 共通エラーの事前回避
   - リトライロジックの追加
```

### AI支援による提案生成
- コマンド使用履歴の分析
- 類似コマンドからの学習
- ベストプラクティスの適用

## 実行例

### 基本的な強化
```
/utilities:enhance-command "clean-commits"
```

### 詳細な最適化指定
```
/utilities:enhance-command "development/tdd-plan プロンプトを簡潔にして実行速度を向上"
```

### 複数コマンドの一括最適化
```
/utilities:enhance-command "全てのdevelopmentカテゴリのコマンドを分析して改善提案"
```

## エラーハンドリング

### 一般的なエラーと対処
1. **コマンドが見つからない**
   - 利用可能なコマンド一覧を表示
   - 類似コマンドの提案

2. **権限不足**
   - 必要な権限の明示
   - 代替アプローチの提案

3. **破壊的変更の警告**
   - 変更前の確認プロンプト
   - 自動バックアップの作成

## 出力フォーマット

### 1. 分析レポート
```markdown
# コマンド分析レポート: [command-name]

## 現状評価
- 強み: [identified strengths]
- 改善機会: [improvement opportunities]
- リスク: [potential risks]

## 最適化提案
[Detailed optimization suggestions]

## 実装計画
[Step-by-step implementation plan]
```

### 2. 強化版コマンド
- オリジナルとの差分表示
- 改善ポイントのハイライト
- 使用方法の更新

### 3. パフォーマンス比較
- Before/Afterの定量的比較
- 期待される効果の明示
- 継続的な改善指標

## 成功基準

1. **実行効率の向上**: 20%以上の速度改善
2. **エラー率の低減**: 50%以上のエラー削減
3. **使いやすさの向上**: より直感的なインターフェース
4. **保守性の改善**: 明確な構造とドキュメント

## 備考

このコマンドは継続的に進化し、使用されるたびに学習と改善を重ねます。フィードバックや改善提案は積極的に取り入れられ、コマンドエコシステム全体の品質向上に貢献します。
