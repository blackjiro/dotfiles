---
name: auto-reviewing
description: コード変更のレビューを実行。「レビューして」「コードチェック」「品質確認」などのキーワードで自動トリガー。
---

# 自動レビュー

実装完了時のコードレビューを実行するスキル。

## トリガーキーワード

- レビューして / レビューお願い
- コードチェック / 品質確認
- review / check code

## 実行手順

1. **変更内容の確認**
   - `git diff --stat` で変更ファイルと行数を確認
   - 軽微な変更（設定変更、リネーム、フォーマット修正など）の場合は「軽微な変更のため詳細レビュー不要」と報告して終了

2. **レビュー実行（両方必須）**

   以下の2つを**必ず両方実行**すること。片方だけで終わらない。

   - [ ] `/pr-review-toolkit:review-pr all` を実行
   - [ ] `codex review` を実行（以下のルールで引数を決定）:
     - 未コミット変更がある場合: `codex review --uncommitted`
     - 未コミット変更がない場合: `codex review --base <デフォルトブランチ>`
       - デフォルトブランチは `git remote show origin | grep 'HEAD branch' | awk '{print $NF}'` で取得

   **注意**: codex コマンドが見つからない場合のみスキップ可。それ以外の理由でスキップしない。

3. **結果の対応**
   - Critical/Important で妥当なもの → 修正
   - Suggestions → 以下の基準で判断:
     - **自動修正する**: 動作が変わらないリファクタリング（命名改善、共通化、不要コード削除、簡略化など）
     - **GitHub issue を作成する**: 公開インターフェース（API、型定義、エクスポート）の変更、新規テストが必要な変更、アーキテクチャレベルの構造変更
   - 判断困難 → ユーザーに確認

4. **繰り返し（重要）**
   - 修正後、手順2に戻り再度レビューを実行
   - 修正が必要な Critical/Important がなくなるまで繰り返す
   - 新たな問題が検出されなくなったら終了

5. **完了報告**
   - 「レビュー完了」とユーザーに報告
   - 残った Suggestions があれば検討事項として一覧を提示

## 注意事項

レビュー結果は必ずしも妥当とは限りません。修正前に妥当性を確認してください。
